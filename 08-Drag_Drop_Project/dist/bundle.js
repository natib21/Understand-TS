(()=>{"use strict";class e{constructor(e,t,n,r){this.templateElement=document.getElementById(e),this.hostElement=document.getElementById(t);const s=document.importNode(this.templateElement.content,!0);this.element=s.firstElementChild,n&&(this.element.id=n),this.attach(r)}attach(e){this.hostElement.insertAdjacentElement(e?"afterbegin":"beforeend",this.element)}}function t(e){let t=!0;return e.required&&"string"==typeof e.value&&(t=t&&0!==e.value.trim().length),null!=e.minLength&&"string"==typeof e.value&&(t=t&&e.value.length>=e.minLength),null!=e.maxLength&&"string"==typeof e.value&&(t=t&&e.value.length<=e.maxLength),null!=e.min&&"number"==typeof e.value&&(t=t&&e.value>=e.min),null!=e.max&&"number"==typeof e.value&&(t=t&&e.value<=e.max),t}function n(e,t,n){const r=n.value;return{configurable:!0,get(){return r.bind(this)}}}var r;!function(e){e[e.Active=0]="Active",e[e.Finished=1]="Finished"}(r||(r={}));class s{constructor(e,t,n,r,s){this.id=e,this.title=t,this.description=n,this.numberOfPeople=r,this.status=s}}class i{constructor(){this.listeners=[]}addListner(e){this.listeners.push(e)}}class l extends i{constructor(){super(),this.projects=[]}static getInstance(){return this.instance||(this.instance=new l),this.instance}addProject(e,t,n){const i=new s(Math.random().toString(),e,t,n,r.Active);this.projects.push(i);for(const e of this.listeners)e(this.projects.slice())}moveProject(e,t){const n=this.projects.find((t=>t.id===e));n&&n.status!==t&&(n.status=t,o.updateListners())}updateListners(){for(const e of this.listeners)e(this.projects.slice())}}const o=l.getInstance();class a extends e{constructor(){super("project-input","app","user-input",!0),this.titleInputElement=this.element.querySelector("#title"),this.descriptionInputElement=this.element.querySelector("#description"),this.peopleInputElement=this.element.querySelector("#people"),this.configure()}gatherUserInputs(){const e=this.titleInputElement.value,n=this.descriptionInputElement.value,r=this.peopleInputElement.value,s={value:n,required:!0,minLength:5},i={value:r,required:!0,min:1,max:5};return t({value:e,required:!0})&&t(s)&&t(i)?[e,n,+r]:void alert("Invalid Input")}clear(){this.titleInputElement.value=" ",this.descriptionInputElement.value=" ",this.peopleInputElement.value=" "}submitHandler(e){e.preventDefault(),console.log(this.titleInputElement.value);const t=this.gatherUserInputs();if(Array.isArray(t)){const[e,n,r]=t;console.log(e,n,r),o.addProject(e,n,r),this.clear()}}renderContent(){}configure(){this.element.addEventListener("submit",this.submitHandler)}}!function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);i>3&&l&&Object.defineProperty(t,n,l)}([n],a.prototype,"submitHandler",null);class c extends e{get persons(){return 1===this.projects.numberOfPeople?"1 person":`${this.projects.numberOfPeople} persons`}constructor(e,t){super("single-project",e,t.id,!1),this.projects=t,this.configure(),this.renderContent()}dragStartHandler(e){e.dataTransfer.setData("text/plain",this.projects.id),e.dataTransfer.effectAllowed="move"}dragEndHandler(e){console.log("DragEnd")}configure(){this.element.addEventListener("dragstart",this.dragStartHandler),this.element.addEventListener("dragend",this.dragEndHandler)}renderContent(){this.element.querySelector("h2").textContent=this.projects.title,this.element.querySelector("h3").textContent=this.persons+" Assinged",this.element.querySelector("p").textContent=this.projects.description}}!function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);i>3&&l&&Object.defineProperty(t,n,l)}([n],c.prototype,"dragStartHandler",null);var d=function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l};class u extends e{constructor(e){super("project-list","app",`${e}-projects`,!1),this.type=e,this.assignedProjects=[],this.configure(),this.renderContent()}renderProjects(){document.getElementById(`${this.type}-projects-list`).innerHTML="";for(const e of this.assignedProjects)new c(this.element.querySelector("ul").id,e)}dragLeaveHandler(e){this.element.querySelector("ul").classList.remove("droppable")}dragOverHandler(e){e.dataTransfer&&"text/plain"===e.dataTransfer.types[0]&&(e.preventDefault(),this.element.querySelector("ul").classList.add("droppable"))}dropHandler(e){const t=e.dataTransfer.getData("text/plain");o.moveProject(t,"active"===this.type?r.Active:r.Finished)}configure(){this.element.addEventListener("dragover",this.dragOverHandler),this.element.addEventListener("dragleave",this.dragLeaveHandler),this.element.addEventListener("drop",this.dropHandler),o.addListner((e=>{const t=e.filter((e=>"active"===this.type?e.status===r.Active:e.status===r.Finished));this.assignedProjects=t,this.renderProjects()}))}renderContent(){const e=`${this.type}-projects-list`;this.element.querySelector("ul").id=e,this.element.querySelector("h2").textContent=this.type.toUpperCase()+" PROJECTS"}}d([n],u.prototype,"dragLeaveHandler",null),d([n],u.prototype,"dragOverHandler",null),d([n],u.prototype,"dropHandler",null),new a,new u("active"),new u("finished")})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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S1EsUUFBUTBELGNBQWMsTUFBT2lDLFlBQWNuRyxLQUFLcUcsS0FBS21CLGNBQWdCLFdBQzlFLEVBdENBLEdBRENoRyxHLHFDQU1ELEdBRENBLEcsb0NBUUQsR0FEQ0EsRyxnQ0NuQ1IsSUFBSXdDLEVBQ0osSUFBSW9DLEVBQVksVUFDaEIsSUFBSUEsRUFBWSxXIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vMDgtZHJhZ19kcm9wX3Byb2plY3QvLi9zcmMvY29tcG9uZW50cy9iYXNlLWNvbXBvbmVudC50cyIsIndlYnBhY2s6Ly8wOC1kcmFnX2Ryb3BfcHJvamVjdC8uL3NyYy91dGlscy92YWxpZGF0aW9uLnRzIiwid2VicGFjazovLzA4LWRyYWdfZHJvcF9wcm9qZWN0Ly4vc3JjL2RlY29yYXRvci9hdXRvYmluZC50cyIsIndlYnBhY2s6Ly8wOC1kcmFnX2Ryb3BfcHJvamVjdC8uL3NyYy9tb2RlbHMvcHJvamVjdC50cyIsIndlYnBhY2s6Ly8wOC1kcmFnX2Ryb3BfcHJvamVjdC8uL3NyYy9zdGF0ZS9wcm9qZWN0LXN0YXRlLnRzIiwid2VicGFjazovLzA4LWRyYWdfZHJvcF9wcm9qZWN0Ly4vc3JjL2NvbXBvbmVudHMvcHJvamVjdC1pbnB1dC50cyIsIndlYnBhY2s6Ly8wOC1kcmFnX2Ryb3BfcHJvamVjdC8uL3NyYy9jb21wb25lbnRzL3Byb2plY3QtaXRlbS50cyIsIndlYnBhY2s6Ly8wOC1kcmFnX2Ryb3BfcHJvamVjdC8uL3NyYy9jb21wb25lbnRzL3Byb2plY3QtbGlzdC50cyIsIndlYnBhY2s6Ly8wOC1kcmFnX2Ryb3BfcHJvamVjdC8uL3NyYy9hcHAudHMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGFic3RyYWN0IGNsYXNzIENvbXBvbmVudDxUIGV4dGVuZHMgSFRNTEVsZW1lbnQsVSBleHRlbmRzIEhUTUxFbGVtZW50ID4ge1xyXG4gICAgdGVtcGxhdGVFbGVtZW50OkhUTUxUZW1wbGF0ZUVsZW1lbnQ7XHJcbiAgICBob3N0RWxlbWVudDpUO1xyXG4gICAgZWxlbWVudDpVO1xyXG4gICAgXHJcblxyXG4gICAgY29uc3RydWN0b3IodGVtcGxhdGVJZDpzdHJpbmcsaG9zdEVsZW1lbnRJZDpzdHJpbmcsbmV3RWxlbWVudElkOnN0cmluZyxpbnNlcnRBdFN0YXJ0OmJvb2xlYW4pe1xyXG4gICAgICAgIHRoaXMudGVtcGxhdGVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGVtcGxhdGVJZCkhIGFzIEhUTUxUZW1wbGF0ZUVsZW1lbnRcclxuICAgICAgICB0aGlzLmhvc3RFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaG9zdEVsZW1lbnRJZCkhIGFzIFRcclxuICAgICAgICBjb25zdCBpbXBvcnRlZE5vZGUgPSBkb2N1bWVudC5pbXBvcnROb2RlKHRoaXMudGVtcGxhdGVFbGVtZW50LmNvbnRlbnQsdHJ1ZSlcclxuICAgICAgICB0aGlzLmVsZW1lbnQgPSBpbXBvcnRlZE5vZGUuZmlyc3RFbGVtZW50Q2hpbGQgYXMgVVxyXG4gICAgICAgIGlmKG5ld0VsZW1lbnRJZCl7XHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5pZCA9IG5ld0VsZW1lbnRJZFxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmF0dGFjaChpbnNlcnRBdFN0YXJ0KSA7ICBcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGF0dGFjaChpbnNlcnRBdFN0YXJ0OiBib29sZWFuKXtcclxuICAgICAgICB0aGlzLmhvc3RFbGVtZW50Lmluc2VydEFkamFjZW50RWxlbWVudChpbnNlcnRBdFN0YXJ0ID8gJ2FmdGVyYmVnaW4nOidiZWZvcmVlbmQnLHRoaXMuZWxlbWVudClcclxuICAgIH1cclxuXHJcbiAgICBhYnN0cmFjdCBjb25maWd1cmUoKTp2b2lkO1xyXG4gICAgYWJzdHJhY3QgcmVuZGVyQ29udGVudCgpOnZvaWQ7XHJcbn0iLCJleHBvcnQgaW50ZXJmYWNlIFZhbGlkYXRhYmxlIHtcclxuICAgIHZhbHVlIDogc3RyaW5nIHwgbnVtYmVyIDtcclxuICAgIHJlcXVpcmVkPyA6IGJvb2xlYW47XHJcbiAgICBtaW5MZW5ndGg/Om51bWJlcjtcclxuICAgIG1heExlbmd0aD86bnVtYmVyO1xyXG4gICAgbWluPzpudW1iZXI7XHJcbiAgICBtYXg/Om51bWJlcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlKHZhbGlkYXRhYmxlSW5wdXQ6IFZhbGlkYXRhYmxlKXtcclxuICAgIGxldCBpc1ZhbGlkID0gdHJ1ZTtcclxuICAgIGlmICh2YWxpZGF0YWJsZUlucHV0LnJlcXVpcmVkKXtcclxuICAgICAgICBpZih0eXBlb2YgdmFsaWRhdGFibGVJbnB1dC52YWx1ZSA9PT0gJ3N0cmluZycpe1xyXG4gICAgICAgICAgICBpc1ZhbGlkID0gaXNWYWxpZCAmJiB2YWxpZGF0YWJsZUlucHV0LnZhbHVlLnRyaW0oKS5sZW5ndGggIT09IDBcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBpZiAodmFsaWRhdGFibGVJbnB1dC5taW5MZW5ndGggIT0gbnVsbCAmJiB0eXBlb2YgdmFsaWRhdGFibGVJbnB1dC52YWx1ZSA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICBpc1ZhbGlkID0gaXNWYWxpZCAmJiB2YWxpZGF0YWJsZUlucHV0LnZhbHVlLmxlbmd0aCA+PSB2YWxpZGF0YWJsZUlucHV0Lm1pbkxlbmd0aDtcclxuICAgIH1cclxuICAgICBpZiAodmFsaWRhdGFibGVJbnB1dC5tYXhMZW5ndGggIT0gbnVsbCAmJiB0eXBlb2YgdmFsaWRhdGFibGVJbnB1dC52YWx1ZSA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICBpc1ZhbGlkID0gaXNWYWxpZCAmJiB2YWxpZGF0YWJsZUlucHV0LnZhbHVlLmxlbmd0aCA8PSB2YWxpZGF0YWJsZUlucHV0Lm1heExlbmd0aDtcclxuICAgIH1cclxuICAgICBpZiAodmFsaWRhdGFibGVJbnB1dC5taW4gIT0gbnVsbCAmJiB0eXBlb2YgdmFsaWRhdGFibGVJbnB1dC52YWx1ZSA9PT0gJ251bWJlcicpIHtcclxuICAgICAgICBpc1ZhbGlkID0gaXNWYWxpZCAmJiB2YWxpZGF0YWJsZUlucHV0LnZhbHVlID49IHZhbGlkYXRhYmxlSW5wdXQubWluO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIENoZWNrIG1heCBmb3IgbnVtYmVyc1xyXG4gICAgaWYgKHZhbGlkYXRhYmxlSW5wdXQubWF4ICE9IG51bGwgJiYgdHlwZW9mIHZhbGlkYXRhYmxlSW5wdXQudmFsdWUgPT09ICdudW1iZXInKSB7XHJcbiAgICAgICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgdmFsaWRhdGFibGVJbnB1dC52YWx1ZSA8PSB2YWxpZGF0YWJsZUlucHV0Lm1heDtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gaXNWYWxpZFxyXG59XHJcbiIsImV4cG9ydCBmdW5jdGlvbiBhdXRvYmluZCh0YXJnZXQ6YW55LG1ldGhvZE5hbWU6c3RyaW5nLGRlc2NyaXB0b3I6UHJvcGVydHlEZXNjcmlwdG9yKXtcclxuICAgIGNvbnN0IG9yaWdpbmFsTWV0aG9kID0gZGVzY3JpcHRvci52YWx1ZVxyXG4gICAvLyAgY29uc29sZS5sb2cob3JpZ2luYWxNZXRob2QpXHJcbiAgICBjb25zdCBhZGpEZXNjcmlwdG9yOiBQcm9wZXJ0eURlc2NyaXB0b3IgPSB7XHJcbiAgICAgICBjb25maWd1cmFibGU6dHJ1ZSxcclxuICAgICAgIGdldCgpe1xyXG4gICAgICAgICAgIGNvbnN0IGJvdW5kRm4gPSBvcmlnaW5hbE1ldGhvZC5iaW5kKHRoaXMpXHJcbiAgICAgICAgICAgcmV0dXJuIGJvdW5kRm5cclxuICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBhZGpEZXNjcmlwdG9yXHJcbiAgIH0iLCJleHBvcnQgZW51bSBQcm9qZWN0U3RhdHVzIHtBY3RpdmUsRmluaXNoZWR9XHJcblxyXG5cclxuZXhwb3J0IGNsYXNzIFByb2plY3Qge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKFxyXG4gICAgICAgIHB1YmxpYyBpZDpzdHJpbmcsXHJcbiAgICAgICAgcHVibGljIHRpdGxlIDpzdHJpbmcsXHJcbiAgICAgICAgcHVibGljIGRlc2NyaXB0aW9uOnN0cmluZyxcclxuICAgICAgICBwdWJsaWMgbnVtYmVyT2ZQZW9wbGU6bnVtYmVyLFxyXG4gICAgICAgIHB1YmxpYyBzdGF0dXM6IFByb2plY3RTdGF0dXNcclxuICAgICl7fVxyXG59XHJcbiIsIiBpbXBvcnQgeyBQcm9qZWN0LCBQcm9qZWN0U3RhdHVzIH0gZnJvbSBcIi4uL21vZGVscy9wcm9qZWN0XCI7XHJcblxyXG4gXHJcbiB0eXBlIExpc3RuZXJzPFQ+ID0gKGl0ZW06VFtdKSA9PiB2b2lkO1xyXG5cclxuIGNsYXNzIFN0YXRlPFQ+IHtcclxuICAgIHByb3RlY3RlZCBsaXN0ZW5lcnMgOkxpc3RuZXJzPFQ+W10gPSBbXTtcclxuXHJcbiAgICBhZGRMaXN0bmVyKExpc3RuZXI6IExpc3RuZXJzPFQ+KXtcclxuICAgICAgICB0aGlzLmxpc3RlbmVycy5wdXNoKExpc3RuZXIpO1xyXG4gICAgICB9IFxyXG59IFxyXG4gXHJcblxyXG5cclxuZXhwb3J0IGNsYXNzIFByb2plY3RTdGF0ZU1nbWcgZXh0ZW5kcyBTdGF0ZTxQcm9qZWN0PiB7XHJcbiAgXHJcbiAgICBwcml2YXRlIHByb2plY3RzIDpQcm9qZWN0IFtdID0gW107XHJcbiAgICBwcml2YXRlIHN0YXRpYyBpbnN0YW5jZTpQcm9qZWN0U3RhdGVNZ21nO1xyXG4gICAgXHJcbiAgICBwcml2YXRlIGNvbnN0cnVjdG9yKCl7XHJcbiAgICBzdXBlcigpXHJcbiAgICB9XHJcbnN0YXRpYyBnZXRJbnN0YW5jZSgpe1xyXG4gICBpZih0aGlzLmluc3RhbmNlKXtcclxuICAgICAgIHJldHVybiB0aGlzLmluc3RhbmNlXHJcbiAgIH1cclxuICAgdGhpcy5pbnN0YW5jZSA9IG5ldyBQcm9qZWN0U3RhdGVNZ21nKClcclxuICAgcmV0dXJuIHRoaXMuaW5zdGFuY2U7XHJcbn1cclxuXHJcbiAgICBhZGRQcm9qZWN0KHRpdGxlOnN0cmluZywgZGVzY3JpcHRpb24gOnN0cmluZyAsbnVtYmVyT2ZQZW9wbGU6bnVtYmVyKXtcclxuXHJcbiAgICAgICBjb25zdCBuZXdQcm9qZWN0ID0gbmV3IFByb2plY3QoXHJcbiAgICAgICAgICAgTWF0aC5yYW5kb20oKS50b1N0cmluZygpLFxyXG4gICAgICAgICAgIHRpdGxlLFxyXG4gICAgICAgICAgIGRlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgIG51bWJlck9mUGVvcGxlLFxyXG4gICAgICAgICAgIFByb2plY3RTdGF0dXMuQWN0aXZlXHJcbiAgICAgICApIFxyXG4gICAgICAgICBcclxuICAgICAgIHRoaXMucHJvamVjdHMucHVzaChuZXdQcm9qZWN0KTtcclxuICAgICAgIGZvciAoY29uc3QgbGlzdG5lckZuIG9mIHRoaXMubGlzdGVuZXJzKXtcclxuICAgICAgICAgICBsaXN0bmVyRm4odGhpcy5wcm9qZWN0cy5zbGljZSgpKTtcclxuICAgICAgIH1cclxuICAgIH1cclxuICAgIG1vdmVQcm9qZWN0KHByb2plY3RJZDpzdHJpbmcsbmV3U3RhdHVzOlByb2plY3RTdGF0dXMpe1xyXG4gICAgICAgIGNvbnN0IHByb2plY3QgPSB0aGlzLnByb2plY3RzLmZpbmQocHJqID0+IHByai5pZCA9PT0gcHJvamVjdElkKVxyXG4gICAgICAgIGlmKHByb2plY3QgJiYgcHJvamVjdC5zdGF0dXMgIT09IG5ld1N0YXR1cyl7ICAgXHJcbiAgICAgICAgICAgIHByb2plY3Quc3RhdHVzID0gbmV3U3RhdHVzO1xyXG4gICAgICAgICAgICBwcm9qZWN0U3RhdGUudXBkYXRlTGlzdG5lcnMoKVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHVwZGF0ZUxpc3RuZXJzKCl7XHJcbiAgICAgICBmb3IgKGNvbnN0IGxpc3RuZXJGbiBvZiB0aGlzLmxpc3RlbmVycyl7XHJcbiAgICAgICAgICAgbGlzdG5lckZuKHRoaXMucHJvamVjdHMuc2xpY2UoKSk7XHJcbiAgICAgICB9XHJcbiAgICB9XHJcbiAgIFxyXG5cclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IHByb2plY3RTdGF0ZSA9IFByb2plY3RTdGF0ZU1nbWcuZ2V0SW5zdGFuY2UoKTtcclxuIiwiaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSAnLi9iYXNlLWNvbXBvbmVudCc7XHJcbmltcG9ydCB7IFZhbGlkYXRhYmxlLHZhbGlkYXRlIH0gZnJvbSAnLi4vdXRpbHMvdmFsaWRhdGlvbic7XHJcbmltcG9ydCB7IGF1dG9iaW5kIH0gZnJvbSAnLi4vZGVjb3JhdG9yL2F1dG9iaW5kJztcclxuaW1wb3J0IHsgcHJvamVjdFN0YXRlIH0gZnJvbSAnLi4vc3RhdGUvcHJvamVjdC1zdGF0ZSc7XHJcblxyXG5leHBvcnQgY2xhc3MgUHJvamVjdElucHV0IGV4dGVuZHMgQ29tcG9uZW50PEhUTUxEaXZFbGVtZW50LEhUTUxGb3JtRWxlbWVudD4ge1xyXG5cclxuICAgIHRpdGxlSW5wdXRFbGVtZW50IDogSFRNTElucHV0RWxlbWVudFxyXG4gICAgZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQgOiBIVE1MSW5wdXRFbGVtZW50XHJcbiAgICBwZW9wbGVJbnB1dEVsZW1lbnQgOiBIVE1MSW5wdXRFbGVtZW50XHJcblxyXG4gICAgY29uc3RydWN0b3IoKXtcclxuICAgICAgICBcclxuICAgICAgICBzdXBlcigncHJvamVjdC1pbnB1dCcsJ2FwcCcsJ3VzZXItaW5wdXQnLHRydWUgKTtcclxuXHJcbiAgICAgICAgdGhpcy50aXRsZUlucHV0RWxlbWVudCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcjdGl0bGUnKSAgYXMgSFRNTElucHV0RWxlbWVudFxyXG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignI2Rlc2NyaXB0aW9uJykgIGFzIEhUTUxJbnB1dEVsZW1lbnRcclxuICAgICAgICB0aGlzLnBlb3BsZUlucHV0RWxlbWVudCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcjcGVvcGxlJykgIGFzIEhUTUxJbnB1dEVsZW1lbnRcclxuICAgICAgICB0aGlzLmNvbmZpZ3VyZSgpXHJcbiAgICAgICAgXHJcbiAgICBcclxuICAgIH1cclxuICAgXHJcblxyXG4gICAgcHJpdmF0ZSBnYXRoZXJVc2VySW5wdXRzKCk6W3N0cmluZyxzdHJpbmcsbnVtYmVyXSB8IHZvaWR7XHJcbiAgICAgICAgY29uc3QgZW50ZXJlZFRpdGxlID0gdGhpcy50aXRsZUlucHV0RWxlbWVudC52YWx1ZTtcclxuICAgICAgICBjb25zdCBlbnRlcmVkRGVzY3JpcHRpb24gPSB0aGlzLmRlc2NyaXB0aW9uSW5wdXRFbGVtZW50LnZhbHVlO1xyXG4gICAgICAgIGNvbnN0IGVudGVyZWRQZW9wbGUgPSB0aGlzLnBlb3BsZUlucHV0RWxlbWVudC52YWx1ZVxyXG5cclxuXHJcbiAgICAgICAgY29uc3QgdGl0bGVWYWxpZGF0YWJsZTogVmFsaWRhdGFibGUgPSB7XHJcbiAgICAgICAgICAgIHZhbHVlOiBlbnRlcmVkVGl0bGUsXHJcbiAgICAgICAgICAgIHJlcXVpcmVkIDogdHJ1ZVxyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBkZXNjcmlwdGlvblZhbGlkYXRhYmxlOiBWYWxpZGF0YWJsZSA9IHtcclxuICAgICAgICAgICAgdmFsdWU6IGVudGVyZWREZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgcmVxdWlyZWQgOiB0cnVlLFxyXG4gICAgICAgICAgICBtaW5MZW5ndGg6NSxcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgcGVvcGxlVmFsaWRhdGFibGU6IFZhbGlkYXRhYmxlID0ge1xyXG4gICAgICAgICAgICB2YWx1ZTogZW50ZXJlZFBlb3BsZSxcclxuICAgICAgICAgICAgcmVxdWlyZWQgOiB0cnVlLFxyXG4gICAgICAgICAgICBtaW46MSxcclxuICAgICAgICAgICAgbWF4OjVcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYoXHJcbiAgICAgICAgIXZhbGlkYXRlKHRpdGxlVmFsaWRhdGFibGUpIHx8IFxyXG4gICAgICAgICF2YWxpZGF0ZShkZXNjcmlwdGlvblZhbGlkYXRhYmxlKSB8fCBcclxuICAgICAgICAhdmFsaWRhdGUocGVvcGxlVmFsaWRhdGFibGUpKXtcclxuICAgICAgICAgICAgYWxlcnQoXCJJbnZhbGlkIElucHV0XCIpXHJcbiAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgIH1lbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIFtlbnRlcmVkVGl0bGUsZW50ZXJlZERlc2NyaXB0aW9uLCtlbnRlcmVkUGVvcGxlXVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGNsZWFyKCl7XHJcbiAgICAgICAgdGhpcy50aXRsZUlucHV0RWxlbWVudC52YWx1ZT0gXCIgXCI7XHJcbiAgICAgICAgdGhpcy5kZXNjcmlwdGlvbklucHV0RWxlbWVudC52YWx1ZSA9XCIgXCI7XHJcbiAgICAgICAgdGhpcy5wZW9wbGVJbnB1dEVsZW1lbnQudmFsdWUgPSBcIiBcIjtcclxuICAgIH1cclxuXHJcblxyXG5cclxuICAgIEBhdXRvYmluZFxyXG4gICAgcHJpdmF0ZSBzdWJtaXRIYW5kbGVyKGV2ZW50OkV2ZW50KXtcclxuICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpXHJcbiAgICAgY29uc29sZS5sb2codGhpcy50aXRsZUlucHV0RWxlbWVudC52YWx1ZSlcclxuICAgICBjb25zdCB1c2VySW5wdXQgPSB0aGlzLmdhdGhlclVzZXJJbnB1dHMoKVxyXG4gICAgIGlmKEFycmF5LmlzQXJyYXkodXNlcklucHV0KSl7XHJcbiAgICAgICAgY29uc3QgW3RpdGxlLGRlc2MscGVvcGxlXSA9IHVzZXJJbnB1dDtcclxuICAgICAgICAgY29uc29sZS5sb2codGl0bGUsZGVzYyxwZW9wbGUpXHJcbiAgICAgICAgIHByb2plY3RTdGF0ZS5hZGRQcm9qZWN0KHRpdGxlLGRlc2MscGVvcGxlKTtcclxuICAgICAgICAgdGhpcy5jbGVhcigpXHJcbiAgICAgfVxyXG4gICAgfVxyXG4gICAgcmVuZGVyQ29udGVudCgpIHtcclxuICAgIH1cclxuICAgICBjb25maWd1cmUoKXtcclxuICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcclxuICAgICAgICAgICAgJ3N1Ym1pdCcsdGhpcy5zdWJtaXRIYW5kbGVyXHJcbiAgICAgICAgKVxyXG4gICAgfVxyXG5cclxuICAgXHJcbn0gIiwiaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSAnLi9iYXNlLWNvbXBvbmVudCc7XHJcbmltcG9ydCB7IFByb2plY3QgfSBmcm9tICcuLi9tb2RlbHMvcHJvamVjdCc7XHJcbmltcG9ydCB7IERyYWdhYWJsZSB9IGZyb20gJy4uL21vZGVscy9kcmFnLWRyb3AnO1xyXG5pbXBvcnQgeyBhdXRvYmluZCB9IGZyb20gJy4uL2RlY29yYXRvci9hdXRvYmluZCc7XHJcblxyXG5leHBvcnQgY2xhc3MgUHJvamVjdEl0ZW0gZXh0ZW5kcyBDb21wb25lbnQ8SFRNTFVMaXN0RWxlbWVudCxIVE1MTElFbGVtZW50PiBpbXBsZW1lbnRzIERyYWdhYWJsZXtcclxuICAgIHByaXZhdGUgcHJvamVjdHMgOlByb2plY3Q7XHJcblxyXG4gICAgZ2V0IHBlcnNvbnMoKXtcclxuICAgICAgICBpZih0aGlzLnByb2plY3RzLm51bWJlck9mUGVvcGxlID09PSAxKXtcclxuICAgICAgICAgICAgcmV0dXJuICcxIHBlcnNvbidcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgcmV0dXJuIGAke3RoaXMucHJvamVjdHMubnVtYmVyT2ZQZW9wbGV9IHBlcnNvbnNgXHJcbiAgICAgICAgfSBcclxuICAgIH1cclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihob3N0SWQ6c3RyaW5nLHByb2plY3Q6UHJvamVjdCl7XHJcbiBzdXBlcignc2luZ2xlLXByb2plY3QnLGhvc3RJZCxwcm9qZWN0LmlkLGZhbHNlKTtcclxuIHRoaXMucHJvamVjdHMgPSBwcm9qZWN0O1xyXG4gdGhpcy5jb25maWd1cmUoKVxyXG4gdGhpcy5yZW5kZXJDb250ZW50KClcclxuICAgIH1cclxuICAgIEBhdXRvYmluZFxyXG4gIGRyYWdTdGFydEhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCk6IHZvaWQge1xyXG4gICBldmVudC5kYXRhVHJhbnNmZXIhLnNldERhdGEoJ3RleHQvcGxhaW4nLHRoaXMucHJvamVjdHMuaWQpXHJcbiAgIGV2ZW50LmRhdGFUcmFuc2ZlciEuZWZmZWN0QWxsb3dlZCA9ICdtb3ZlJ1xyXG4gICAgXHJcbiB9XHJcblxyXG4gIGRyYWdFbmRIYW5kbGVyKF86IERyYWdFdmVudCk6IHZvaWQge1xyXG4gICAgY29uc29sZS5sb2coJ0RyYWdFbmQnKVxyXG4gfVxyXG4gICAgY29uZmlndXJlKCkge1xyXG4gICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ3N0YXJ0Jyx0aGlzLmRyYWdTdGFydEhhbmRsZXIpXHJcbiAgICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcmFnZW5kJyx0aGlzLmRyYWdFbmRIYW5kbGVyKVxyXG4gICAgfVxyXG4gICAgcmVuZGVyQ29udGVudCgpIHtcclxuICAgICAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignaDInKSEudGV4dENvbnRlbnQgPSB0aGlzLnByb2plY3RzLnRpdGxlO1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICAgICAgICAnaDMnXHJcbiAgICAgICAgKSEudGV4dENvbnRlbnQgPSB0aGlzLnBlcnNvbnMgKyAnIEFzc2luZ2VkJztcclxuICAgICAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcigncCcpIS50ZXh0Q29udGVudCA9IHRoaXMucHJvamVjdHMuZGVzY3JpcHRpb247XHJcbiAgICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSAnLi9iYXNlLWNvbXBvbmVudCc7XHJcbmltcG9ydCB7IFByb2plY3RJdGVtIH0gZnJvbSAnLi9wcm9qZWN0LWl0ZW0nO1xyXG5pbXBvcnQgeyBQcm9qZWN0LFByb2plY3RTdGF0dXMgfSBmcm9tICcuLi9tb2RlbHMvcHJvamVjdCc7XHJcbmltcG9ydCB7IGF1dG9iaW5kIH0gZnJvbSAnLi4vZGVjb3JhdG9yL2F1dG9iaW5kJztcclxuaW1wb3J0IHsgcHJvamVjdFN0YXRlIH0gZnJvbSAnLi4vc3RhdGUvcHJvamVjdC1zdGF0ZSc7XHJcbmltcG9ydCB7IERyYWdUYXJnZXQgfSBmcm9tICcuLi9tb2RlbHMvZHJhZy1kcm9wJztcclxuXHJcblxyXG5cclxuZXhwb3J0IGNsYXNzIFByb2plY3RMaXN0IGV4dGVuZHMgQ29tcG9uZW50PEhUTUxEaXZFbGVtZW50LEhUTUxFbGVtZW50PiBpbXBsZW1lbnRzIERyYWdUYXJnZXR7XHJcbiAgIFxyXG4gICAgYXNzaWduZWRQcm9qZWN0czpQcm9qZWN0IFtdID0gW107XHJcblxyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSB0eXBlOiAnYWN0aXZlJ3wnZmluaXNoZWQnKXtcclxuICAgICAgICBzdXBlcigncHJvamVjdC1saXN0JywnYXBwJywgYCR7dHlwZX0tcHJvamVjdHNgLGZhbHNlKVxyXG4gICAgICAgICAgdGhpcy5jb25maWd1cmUoKSAgICBcclxuICAgICAgICAgIHRoaXMucmVuZGVyQ29udGVudCgpXHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICBcclxuICAgICAgICBwcml2YXRlIHJlbmRlclByb2plY3RzKCl7XHJcbiAgICAgICAgICBjb25zdCBsaXN0RWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgJHt0aGlzLnR5cGV9LXByb2plY3RzLWxpc3RgKSEgYXMgSFRNTFVMaXN0RWxlbWVudCBcclxuICAgICAgICAgIGxpc3RFbC5pbm5lckhUTUwgPVwiXCI7XHJcbiAgICAgICAgICBmb3IgKGNvbnN0IHByakl0ZW0gb2YgdGhpcy5hc3NpZ25lZFByb2plY3RzKXtcclxuICAgICAgICAgICBuZXcgUHJvamVjdEl0ZW0odGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3VsJykhLmlkLHByakl0ZW0pXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIEBhdXRvYmluZFxyXG4gICAgICAgIGRyYWdMZWF2ZUhhbmRsZXIoXzogRHJhZ0V2ZW50KTogdm9pZCB7XHJcbiAgICAgICAgICAgIGNvbnN0IGxpc3RFbCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCd1bCcpISBhcyBIVE1MVUxpc3RFbGVtZW50O1xyXG4gICAgICAgICAgICBsaXN0RWwuY2xhc3NMaXN0LnJlbW92ZSgnZHJvcHBhYmxlJylcclxuICAgICAgICB9XHJcbiAgICAgICAgQGF1dG9iaW5kXHJcbiAgICAgICAgZHJhZ092ZXJIYW5kbGVyKGV2ZW50OiBEcmFnRXZlbnQpOiB2b2lkIHtcclxuICAgICAgICAgICAgaWYoZXZlbnQuZGF0YVRyYW5zZmVyICYmIGV2ZW50LmRhdGFUcmFuc2Zlci50eXBlc1swXSA9PT0gJ3RleHQvcGxhaW4nKXtcclxuICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGxpc3RFbCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCd1bCcpISBhcyBIVE1MVUxpc3RFbGVtZW50O1xyXG4gICAgICAgICAgICBsaXN0RWwuY2xhc3NMaXN0LmFkZCgnZHJvcHBhYmxlJylcclxuICAgICAgICB9XHJcbiAgICB9ICAgQGF1dG9iaW5kXHJcbiAgICAgICAgZHJvcEhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCkge1xyXG4gICAgICAgICAgICBjb25zdCBwcmpJZCA9IGV2ZW50LmRhdGFUcmFuc2ZlciEuZ2V0RGF0YSgndGV4dC9wbGFpbicpXHJcbiAgICAgICAgICAgIHByb2plY3RTdGF0ZS5tb3ZlUHJvamVjdChwcmpJZCx0aGlzLnR5cGUgPT09ICdhY3RpdmUnID8gUHJvamVjdFN0YXR1cy5BY3RpdmUgOiBQcm9qZWN0U3RhdHVzLkZpbmlzaGVkKVxyXG4gICAgICAgIH1cclxuICAgICAgICAgY29uZmlndXJlKCl7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ292ZXInLHRoaXMuZHJhZ092ZXJIYW5kbGVyKVxyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2xlYXZlJyx0aGlzLmRyYWdMZWF2ZUhhbmRsZXIpXHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcm9wJyx0aGlzLmRyb3BIYW5kbGVyKVxyXG4gICAgICAgICAgICBwcm9qZWN0U3RhdGUuYWRkTGlzdG5lcigocHJvamVjdHM6IFByb2plY3RbXSk9PntcclxuICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIGNvbnN0IHJlbGF2YW50UHJvamVjdHMgPSBwcm9qZWN0cy5maWx0ZXIoKGl0ZW0pPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgaWYodGhpcy50eXBlID09PSAnYWN0aXZlJyl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0uc3RhdHVzID09PSBQcm9qZWN0U3RhdHVzLkFjdGl2ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0uc3RhdHVzID09PSBQcm9qZWN0U3RhdHVzLkZpbmlzaGVkO1xyXG4gICAgICAgICAgICAgICAgICB9KVxyXG4gIFxyXG4gICAgICAgICAgICAgICAgICB0aGlzLmFzc2lnbmVkUHJvamVjdHMgPSByZWxhdmFudFByb2plY3RzO1xyXG4gICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlclByb2plY3RzKClcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIHJlbmRlckNvbnRlbnQoKXtcclxuICAgICAgICAgICAgY29uc3QgbGlzdElkID0gYCR7dGhpcy50eXBlfS1wcm9qZWN0cy1saXN0YDtcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3VsJykhLmlkID0gbGlzdElkO1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignaDInKSEudGV4dENvbnRlbnQgPSB0aGlzLnR5cGUudG9VcHBlckNhc2UoKSArICcgUFJPSkVDVFMnXHJcbiAgICAgICAgfVxyXG59XHJcbiIsIlxyXG5pbXBvcnQgeyBQcm9qZWN0SW5wdXQgfSBmcm9tIFwiLi9jb21wb25lbnRzL3Byb2plY3QtaW5wdXRcIjtcclxuaW1wb3J0IHsgUHJvamVjdExpc3QgfSBmcm9tIFwiLi9jb21wb25lbnRzL3Byb2plY3QtbGlzdFwiO1xyXG5cclxuIG5ldyBQcm9qZWN0SW5wdXQoKTtcclxuIG5ldyBQcm9qZWN0TGlzdCgnYWN0aXZlJyk7XHJcbiBuZXcgUHJvamVjdExpc3QoJ2ZpbmlzaGVkJyk7XHJcblxyXG4vLy8gTGVjdHVyZSAxMjMiXSwibmFtZXMiOlsiQ29tcG9uZW50IiwiY29uc3RydWN0b3IiLCJ0ZW1wbGF0ZUlkIiwiaG9zdEVsZW1lbnRJZCIsIm5ld0VsZW1lbnRJZCIsImluc2VydEF0U3RhcnQiLCJ0aGlzIiwidGVtcGxhdGVFbGVtZW50IiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImhvc3RFbGVtZW50IiwiaW1wb3J0ZWROb2RlIiwiaW1wb3J0Tm9kZSIsImNvbnRlbnQiLCJlbGVtZW50IiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJpZCIsImF0dGFjaCIsImluc2VydEFkamFjZW50RWxlbWVudCIsInZhbGlkYXRlIiwidmFsaWRhdGFibGVJbnB1dCIsImlzVmFsaWQiLCJyZXF1aXJlZCIsInZhbHVlIiwidHJpbSIsImxlbmd0aCIsIm1pbkxlbmd0aCIsIm1heExlbmd0aCIsIm1pbiIsIm1heCIsImF1dG9iaW5kIiwidGFyZ2V0IiwibWV0aG9kTmFtZSIsImRlc2NyaXB0b3IiLCJvcmlnaW5hbE1ldGhvZCIsImNvbmZpZ3VyYWJsZSIsImdldCIsImJpbmQiLCJQcm9qZWN0U3RhdHVzIiwiUHJvamVjdCIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJudW1iZXJPZlBlb3BsZSIsInN0YXR1cyIsIlN0YXRlIiwibGlzdGVuZXJzIiwiYWRkTGlzdG5lciIsIkxpc3RuZXIiLCJwdXNoIiwiUHJvamVjdFN0YXRlTWdtZyIsInN1cGVyIiwicHJvamVjdHMiLCJnZXRJbnN0YW5jZSIsImluc3RhbmNlIiwiYWRkUHJvamVjdCIsIm5ld1Byb2plY3QiLCJNYXRoIiwicmFuZG9tIiwidG9TdHJpbmciLCJBY3RpdmUiLCJsaXN0bmVyRm4iLCJzbGljZSIsIm1vdmVQcm9qZWN0IiwicHJvamVjdElkIiwibmV3U3RhdHVzIiwicHJvamVjdCIsImZpbmQiLCJwcmoiLCJwcm9qZWN0U3RhdGUiLCJ1cGRhdGVMaXN0bmVycyIsIlByb2plY3RJbnB1dCIsInRpdGxlSW5wdXRFbGVtZW50IiwicXVlcnlTZWxlY3RvciIsImRlc2NyaXB0aW9uSW5wdXRFbGVtZW50IiwicGVvcGxlSW5wdXRFbGVtZW50IiwiY29uZmlndXJlIiwiZ2F0aGVyVXNlcklucHV0cyIsImVudGVyZWRUaXRsZSIsImVudGVyZWREZXNjcmlwdGlvbiIsImVudGVyZWRQZW9wbGUiLCJkZXNjcmlwdGlvblZhbGlkYXRhYmxlIiwicGVvcGxlVmFsaWRhdGFibGUiLCJhbGVydCIsImNsZWFyIiwic3VibWl0SGFuZGxlciIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJjb25zb2xlIiwibG9nIiwidXNlcklucHV0IiwiQXJyYXkiLCJpc0FycmF5IiwiZGVzYyIsInBlb3BsZSIsInJlbmRlckNvbnRlbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiUHJvamVjdEl0ZW0iLCJwZXJzb25zIiwiaG9zdElkIiwiZHJhZ1N0YXJ0SGFuZGxlciIsImRhdGFUcmFuc2ZlciIsInNldERhdGEiLCJlZmZlY3RBbGxvd2VkIiwiZHJhZ0VuZEhhbmRsZXIiLCJfIiwidGV4dENvbnRlbnQiLCJQcm9qZWN0TGlzdCIsInR5cGUiLCJhc3NpZ25lZFByb2plY3RzIiwicmVuZGVyUHJvamVjdHMiLCJpbm5lckhUTUwiLCJwcmpJdGVtIiwiZHJhZ0xlYXZlSGFuZGxlciIsImNsYXNzTGlzdCIsInJlbW92ZSIsImRyYWdPdmVySGFuZGxlciIsInR5cGVzIiwiYWRkIiwiZHJvcEhhbmRsZXIiLCJwcmpJZCIsImdldERhdGEiLCJGaW5pc2hlZCIsInJlbGF2YW50UHJvamVjdHMiLCJmaWx0ZXIiLCJpdGVtIiwibGlzdElkIiwidG9VcHBlckNhc2UiXSwic291cmNlUm9vdCI6IiJ9